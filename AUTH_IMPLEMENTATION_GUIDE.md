# èªè¨¼ã‚·ã‚¹ãƒ†ãƒ å®Œå…¨å®Ÿè£…ã‚¬ã‚¤ãƒ‰ã€çµ±åˆç‰ˆã€‘

> **ç›®çš„:** ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã€ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã€ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã®3å±¤ã™ã¹ã¦ã§å®Œç’§ãªèªè¨¼ã‚·ã‚¹ãƒ†ãƒ ã‚’æ§‹ç¯‰ã™ã‚‹

---

## ğŸ“‹ å…¨ä½“åƒ

ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ã¯ã€**ã‚¨ãƒ³ãƒ‰ãƒ¦ãƒ¼ã‚¶ãƒ¼** ã¨ **ç®¡ç†è€…** ã®2ã¤ã®å½¹å‰²ã‚’æŒã¤èªè¨¼ã‚·ã‚¹ãƒ†ãƒ ã‚’å®Ÿè£…ã—ã¾ã™ã€‚

### ã‚·ã‚¹ãƒ†ãƒ æ§‹æˆ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        Frontend (React)                       â”‚
â”‚  ãƒ»SelectRole ãƒšãƒ¼ã‚¸ï¼ˆå½¹å‰²é¸æŠï¼‰                               â”‚
â”‚  ãƒ»Login/Register ãƒšãƒ¼ã‚¸ï¼ˆèªè¨¼UI)                             â”‚
â”‚  ãƒ»Protected Routesï¼ˆãƒ«ãƒ¼ãƒˆä¿è­·ï¼‰                              â”‚
â”‚  ãƒ»AuthContextï¼ˆèªè¨¼çŠ¶æ…‹ç®¡ç†ï¼‰                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚ HTTP Request (JWT Bearer Token)
                 â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     Backend (Node.js/Express)                â”‚
â”‚  ãƒ»/api/auth/register ï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼ç™»éŒ²ï¼‰                         â”‚
â”‚  ãƒ»/api/auth/login ï¼ˆãƒ­ã‚°ã‚¤ãƒ³ï¼‰                                â”‚
â”‚  ãƒ»/api/auth/me ï¼ˆç¾åœ¨ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼å–å¾—ï¼‰                          â”‚
â”‚  ãƒ»authMiddleware ï¼ˆJWTæ¤œè¨¼ï¼‰                                  â”‚
â”‚  ãƒ»authorize() ï¼ˆå½¹å‰²ãƒã‚§ãƒƒã‚¯ï¼‰                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚ SQL Query
                 â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Database (MySQL)                        â”‚
â”‚  ãƒ»users ãƒ†ãƒ¼ãƒ–ãƒ«                                              â”‚
â”‚    - id, name, email, password (bcrypt), role, is_active    â”‚
â”‚  ãƒ»Migration 004: èªè¨¼ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰è¿½åŠ                             â”‚
â”‚  ãƒ»Seed 004: ãƒ†ã‚¹ãƒˆã‚¢ã‚«ã‚¦ãƒ³ãƒˆä½œæˆ                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¯ å®Ÿè£…ã®æµã‚Œ

### å…¨ä½“ã®å®Ÿè£…é †åº

```
1. Database Layerï¼ˆãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è¨­è¨ˆï¼‰
   â””â”€ Migration + Seed ã‚’å®Ÿè¡Œã—ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’æº–å‚™

2. Backend Layerï¼ˆAPIå®Ÿè£…ï¼‰
   â””â”€ èªè¨¼ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã€ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ã€ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¼ã‚’å®Ÿè£…

3. Frontend Layerï¼ˆUIå®Ÿè£…ï¼‰
   â””â”€ ãƒ­ã‚°ã‚¤ãƒ³/ç™»éŒ²ç”»é¢ã€ä¿è­·ã•ã‚ŒãŸãƒ«ãƒ¼ãƒˆã€çŠ¶æ…‹ç®¡ç†ã‚’å®Ÿè£…

4. End-to-End Testingï¼ˆçµåˆãƒ†ã‚¹ãƒˆï¼‰
   â””â”€ å®Ÿéš›ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ•ãƒ­ãƒ¼ã‚’ãƒ–ãƒ©ã‚¦ã‚¶ã§ç¢ºèª
```

---

## ğŸ“š å„ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®å½¹å‰²

| ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ | å¯¾è±¡ãƒ¬ã‚¤ãƒ¤ãƒ¼ | å†…å®¹ |
|------------|------------|------|
| **DATABASE_AUTH_IMPLEMENTATION.md** | ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ | Migration 004/Seed 004 ã®å®Ÿè£…æ‰‹é † |
| **BACKEND_AUTH_IMPLEMENTATION.md** | ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ | JWTèªè¨¼APIã€ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ã€ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¼å®Ÿè£… |
| **FRONTEND_AUTH_IMPLEMENTATION.md** | ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ | èªè¨¼UIã€Protected Routesã€AuthContextå®Ÿè£… |
| **README.md**ï¼ˆæœ¬ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆï¼‰ | çµ±åˆ | å…¨ä½“ã®æµã‚Œã¨å®Ÿè£…ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ |

---

## âœ… å®Ÿè£…ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

### Phase 1: ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æº–å‚™

- [ ] **Migration 004 ä½œæˆ**
  - ãƒ•ã‚¡ã‚¤ãƒ«: `db/migrations/004_add_auth_to_users.sql`
  - å†…å®¹: `password`, `role`, `is_active`, `last_login_at`, `updated_at` ã‚«ãƒ©ãƒ ã‚’è¿½åŠ 
  - å‚ç…§: `DATABASE_AUTH_IMPLEMENTATION.md` â†’ ã€Œ3. Migrationå®Ÿè£…ã€

- [ ] **Seed 007 ä½œæˆ**
  - ãƒ•ã‚¡ã‚¤ãƒ«: `db/seeds/007_auth_users.sql`
  - å†…å®¹: ãƒ†ã‚¹ãƒˆã‚¢ã‚«ã‚¦ãƒ³ãƒˆä½œæˆï¼ˆç®¡ç†è€…: admin@example.com, ä¸€èˆ¬: hanako@example.comï¼‰
  - å‚ç…§: `DATABASE_AUTH_IMPLEMENTATION.md` â†’ ã€Œ4. Seedå®Ÿè£…ã€

- [ ] **ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè¡Œ**
  ```bash
  cd /Users/haytakeda/Sites/RESTAPI
  mysql -u root -p
  SOURCE db/migrations/004_add_auth_to_users.sql;
  ```
  - å‚ç…§: `DATABASE_AUTH_IMPLEMENTATION.md` â†’ ã€Œ5. å®Ÿè¡Œæ‰‹é †ã€

- [ ] **ã‚·ãƒ¼ãƒ‰ãƒ‡ãƒ¼ã‚¿æŠ•å…¥å®Ÿè¡Œ**
  ```bash
  SOURCE db/seeds/007_auth_users.sql;
  ```

- [ ] **ãƒ‡ãƒ¼ã‚¿ç¢ºèª**
  ```bash
  mysql -u root -p app_db
  SELECT id, name, email, role, is_active FROM users;
  ```
  - æœŸå¾…çµæœ: admin, hanako, taro ã®3ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãŒå­˜åœ¨

### Phase 2: ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰å®Ÿè£…

- [ ] **ä¾å­˜é–¢ä¿‚ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«**
  ```bash
  cd backend
  npm install bcrypt@^5.1.1 jsonwebtoken@^9.0.2 dotenv@^16.4.1
  ```
  - å‚ç…§: `BACKEND_AUTH_IMPLEMENTATION.md` â†’ ã€Œ3. ä¾å­˜é–¢ä¿‚ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã€

- [ ] **ç’°å¢ƒå¤‰æ•°è¨­å®š**
  - ãƒ•ã‚¡ã‚¤ãƒ«: `backend/.env`
  - å†…å®¹: `JWT_SECRET=your-secret-key-here`
  - å‚ç…§: `BACKEND_AUTH_IMPLEMENTATION.md` â†’ ã€Œ4. ç’°å¢ƒå¤‰æ•°è¨­å®šã€

- [ ] **JWTãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ä½œæˆ**
  - ãƒ•ã‚¡ã‚¤ãƒ«: `backend/src/utils/jwtUtils.js`
  - å†…å®¹: `generateToken()`, `verifyToken()`
  - å‚ç…§: `BACKEND_AUTH_IMPLEMENTATION.md` â†’ ã€Œ5. JWTãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£å®Ÿè£…ã€

- [ ] **èªè¨¼ã‚µãƒ¼ãƒ“ã‚¹ä½œæˆ**
  - ãƒ•ã‚¡ã‚¤ãƒ«: `backend/src/services/authService.js`
  - å†…å®¹: `registerUser()`, `loginUser()`, `getUserForAuth()`
  - å‚ç…§: `BACKEND_AUTH_IMPLEMENTATION.md` â†’ ã€Œãƒ¢ãƒ‡ãƒ«/ã‚µãƒ¼ãƒ“ã‚¹å®Ÿè£…ã€

- [ ] **ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ¢ãƒ‡ãƒ«æ‹¡å¼µ**
  - ãƒ•ã‚¡ã‚¤ãƒ«: `backend/src/models/userModel.js`ï¼ˆæ—¢å­˜ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ›´æ–°ï¼‰
  - å†…å®¹: `findByEmail()`, `findByEmailWithPassword()`, `findByIdForAuth()` ãªã©
  - å‚ç…§: `BACKEND_AUTH_IMPLEMENTATION.md` â†’ ã€Œãƒ¢ãƒ‡ãƒ«/ã‚µãƒ¼ãƒ“ã‚¹å®Ÿè£…ã€

- [ ] **èªè¨¼ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ä½œæˆ**
  - ãƒ•ã‚¡ã‚¤ãƒ«: `backend/src/middlewares/authMiddleware.js`
  - å†…å®¹: `authenticate()`, `authorize()`
  - å‚ç…§: `BACKEND_AUTH_IMPLEMENTATION.md` â†’ ã€Œ6. èªè¨¼ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢å®Ÿè£…ã€

- [ ] **èªè¨¼ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¼ä½œæˆ**
  - ãƒ•ã‚¡ã‚¤ãƒ«: `backend/src/controllers/authController.js`
  - å†…å®¹: `register()`, `login()`, `getCurrentUser()`, `logout()`
  - å‚ç…§: `BACKEND_AUTH_IMPLEMENTATION.md` â†’ ã€Œ7. èªè¨¼ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¼å®Ÿè£…ã€

- [ ] **èªè¨¼ãƒ«ãƒ¼ãƒˆä½œæˆ**
  - ãƒ•ã‚¡ã‚¤ãƒ«: `backend/src/routes/auth.js`
  - å†…å®¹: `/register`, `/login`, `/me`, `/logout`
  - å‚ç…§: `BACKEND_AUTH_IMPLEMENTATION.md` â†’ ã€Œ8. èªè¨¼ãƒ«ãƒ¼ãƒˆå®Ÿè£…ã€

- [ ] **ãƒ¡ã‚¤ãƒ³ãƒ«ãƒ¼ãƒˆæ›´æ–°**
  - ãƒ•ã‚¡ã‚¤ãƒ«: `backend/src/routes/index.js`
  - å¤‰æ›´: `router.use('/auth', authRoutes);` ã‚’è¿½åŠ 
  - å‚ç…§: `BACKEND_AUTH_IMPLEMENTATION.md` â†’ ã€Œ9. ãƒ«ãƒ¼ãƒˆçµ±åˆã€

- [ ] **æ—¢å­˜ãƒ«ãƒ¼ãƒˆä¿è­·**
  - ãƒ•ã‚¡ã‚¤ãƒ«: `backend/src/routes/users.js`
  - å¤‰æ›´: `authenticate`, `authorize('admin')` ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ã‚’è¿½åŠ 
  - å‚ç…§: `BACKEND_AUTH_IMPLEMENTATION.md` â†’ ã€Œ10. æ—¢å­˜ãƒ«ãƒ¼ãƒˆã®ä¿è­·ã€

- [ ] **ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ãƒ†ã‚¹ãƒˆ**
  ```bash
  cd backend
  npm run dev
  
  # åˆ¥ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã§
  curl -X POST http://localhost:3000/api/auth/login \
    -H "Content-Type: application/json" \
    -d '{"email":"hanako@example.com","password":"password123"}'
  ```
  - æœŸå¾…çµæœ: `{ "success": true, "data": { "token": "...", "user": {...} } }`
  - å‚ç…§: `BACKEND_AUTH_IMPLEMENTATION.md` â†’ ã€Œ11. ãƒ†ã‚¹ãƒˆæ–¹æ³•ã€

### Phase 3: ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰å®Ÿè£…

- [ ] **èªè¨¼ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆä½œæˆ**
  - ãƒ•ã‚¡ã‚¤ãƒ«: `frontend/src/contexts/AuthContext.jsx`
  - å†…å®¹: `AuthProvider`, `useAuth()`
  - å‚ç…§: `FRONTEND_AUTH_IMPLEMENTATION.md` â†’ ã€Œèªè¨¼ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆå®Ÿè£…ã€

- [ ] **httpClient æ›´æ–°**
  - ãƒ•ã‚¡ã‚¤ãƒ«: `frontend/src/services/httpClient.js`
  - å¤‰æ›´: è‡ªå‹•çš„ã«JWTãƒˆãƒ¼ã‚¯ãƒ³ã‚’ä»˜ä¸
  - å‚ç…§: `FRONTEND_AUTH_IMPLEMENTATION.md` â†’ ã€ŒAPIé€šä¿¡å±¤ã®æ›´æ–°ã€

- [ ] **authAPI ä½œæˆ**
  - ãƒ•ã‚¡ã‚¤ãƒ«: `frontend/src/services/authAPI.js`
  - å†…å®¹: `login()`, `register()`, `getMe()`, `logout()`
  - å‚ç…§: `FRONTEND_AUTH_IMPLEMENTATION.md` â†’ ã€ŒAPIé€šä¿¡å±¤ã®æ›´æ–°ã€

- [ ] **ãƒ¦ãƒ¼ã‚¶ãƒ¼APIçµ±ä¸€**
  - ãƒ•ã‚¡ã‚¤ãƒ«: `frontend/src/services/api.js`ï¼ˆæ—¢å­˜ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ›´æ–°ï¼‰
  - å¤‰æ›´: `httpClient` ã‚’ä½¿ç”¨ã—ã¦èªè¨¼ãƒ˜ãƒƒãƒ€ãƒ¼ã‚’ä»˜ä¸
  - å‚ç…§: `FRONTEND_AUTH_IMPLEMENTATION.md` â†’ ã€ŒAPIé€šä¿¡å±¤ã®æ›´æ–°ã€

- [ ] **ãƒ­ã‚°ã‚¤ãƒ³ãƒšãƒ¼ã‚¸ä½œæˆ**
  - ãƒ•ã‚¡ã‚¤ãƒ«: `frontend/src/pages/LoginPage.jsx`
  - å†…å®¹: ã‚¨ãƒ³ãƒ‰ãƒ¦ãƒ¼ã‚¶ãƒ¼å‘ã‘ãƒ­ã‚°ã‚¤ãƒ³UI
  - å‚ç…§: `FRONTEND_AUTH_IMPLEMENTATION.md` â†’ ã€Œãƒ­ã‚°ã‚¤ãƒ³ãƒšãƒ¼ã‚¸å®Ÿè£…ã€

- [ ] **ç®¡ç†è€…ãƒ­ã‚°ã‚¤ãƒ³ãƒšãƒ¼ã‚¸ä½œæˆ**
  - ãƒ•ã‚¡ã‚¤ãƒ«: `frontend/src/pages/AdminLoginPage.jsx`
  - å†…å®¹: ç®¡ç†è€…å‘ã‘ãƒ­ã‚°ã‚¤ãƒ³UI
  - å‚ç…§: `FRONTEND_AUTH_IMPLEMENTATION.md` â†’ ã€Œç®¡ç†è€…ç”¨ãƒ­ã‚°ã‚¤ãƒ³ãƒšãƒ¼ã‚¸ã€

- [ ] **ç™»éŒ²ãƒšãƒ¼ã‚¸ä½œæˆ**
  - ãƒ•ã‚¡ã‚¤ãƒ«: `frontend/src/pages/RegisterPage.jsx`
  - å†…å®¹: æ–°è¦ãƒ¦ãƒ¼ã‚¶ãƒ¼ç™»éŒ²UI
  - å‚ç…§: `FRONTEND_AUTH_IMPLEMENTATION.md` â†’ ã€Œç™»éŒ²ãƒšãƒ¼ã‚¸å®Ÿè£…ã€

- [ ] **Protected Route ä½œæˆ**
  - ãƒ•ã‚¡ã‚¤ãƒ«: `frontend/src/components/ProtectedRoute.jsx`
  - å†…å®¹: ãƒ«ãƒ¼ãƒˆä¿è­·ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
  - å‚ç…§: `FRONTEND_AUTH_IMPLEMENTATION.md` â†’ ã€ŒProtected Routeså®Ÿè£…ã€

- [ ] **ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°æ›´æ–°**
  - ãƒ•ã‚¡ã‚¤ãƒ«: `frontend/src/main.jsx`
  - å¤‰æ›´: `AuthProvider` ã§ãƒ©ãƒƒãƒ—ã€ä¿è­·ã•ã‚ŒãŸãƒ«ãƒ¼ãƒˆè¨­å®š
  - å‚ç…§: `FRONTEND_AUTH_IMPLEMENTATION.md` â†’ ã€Œãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°æ›´æ–°ã€

- [ ] **ãƒ˜ãƒƒãƒ€ãƒ¼æ›´æ–°**
  - ãƒ•ã‚¡ã‚¤ãƒ«: `frontend/src/components/Header.jsx`
  - å¤‰æ›´: ãƒ¦ãƒ¼ã‚¶ãƒ¼åè¡¨ç¤ºã€ãƒ­ã‚°ã‚¢ã‚¦ãƒˆãƒœã‚¿ãƒ³è¿½åŠ 
  - å‚ç…§: `FRONTEND_AUTH_IMPLEMENTATION.md` â†’ ã€Œãƒ˜ãƒƒãƒ€ãƒ¼ã®æ›´æ–°ã€

- [ ] **ã‚¹ã‚¿ã‚¤ãƒªãƒ³ã‚°è¿½åŠ **
  - ãƒ•ã‚¡ã‚¤ãƒ«: `frontend/src/styles/components.css`
  - è¿½åŠ : èªè¨¼ãƒšãƒ¼ã‚¸ã€ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã€ã‚¨ãƒ©ãƒ¼ãƒšãƒ¼ã‚¸ã®ã‚¹ã‚¿ã‚¤ãƒ«
  - å‚ç…§: `FRONTEND_AUTH_IMPLEMENTATION.md` â†’ ã€Œã‚¹ã‚¿ã‚¤ãƒªãƒ³ã‚°ã€

- [ ] **ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ãƒ†ã‚¹ãƒˆ**
  ```bash
  cd frontend
  npm run dev
  ```
  - ãƒ–ãƒ©ã‚¦ã‚¶ã§ `http://localhost:5173/` ã«ã‚¢ã‚¯ã‚»ã‚¹
  - å‚ç…§: `FRONTEND_AUTH_IMPLEMENTATION.md` â†’ ã€Œãƒ†ã‚¹ãƒˆæ–¹æ³•ã€

### Phase 4: çµåˆãƒ†ã‚¹ãƒˆ

- [ ] **ã‚·ãƒŠãƒªã‚ª1: æ–°è¦ãƒ¦ãƒ¼ã‚¶ãƒ¼ç™»éŒ²**
  1. ãƒˆãƒƒãƒ—ãƒšãƒ¼ã‚¸ â†’ ã€Œã‚¨ãƒ³ãƒ‰ãƒ¦ãƒ¼ã‚¶ãƒ¼ã€é¸æŠ
  2. ã€Œã“ã¡ã‚‰ã‹ã‚‰ç™»éŒ²ã€ãƒªãƒ³ã‚¯ â†’ ç™»éŒ²ãƒ•ã‚©ãƒ¼ãƒ å…¥åŠ›
  3. ç™»éŒ²æˆåŠŸ â†’ `/mypage` ã«ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ
  4. ãƒ˜ãƒƒãƒ€ãƒ¼ã«ãƒ¦ãƒ¼ã‚¶ãƒ¼åãŒè¡¨ç¤ºã•ã‚Œã‚‹

- [ ] **ã‚·ãƒŠãƒªã‚ª2: ãƒ­ã‚°ã‚¤ãƒ³**
  1. ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ
  2. ãƒˆãƒƒãƒ—ãƒšãƒ¼ã‚¸ â†’ ã€Œã‚¨ãƒ³ãƒ‰ãƒ¦ãƒ¼ã‚¶ãƒ¼ã€é¸æŠ
  3. ãƒ¡ãƒ¼ãƒ«: hanako@example.com, ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰: password123
  4. ãƒ­ã‚°ã‚¤ãƒ³æˆåŠŸ â†’ `/mypage` ã«ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ

- [ ] **ã‚·ãƒŠãƒªã‚ª3: ç®¡ç†è€…ãƒ­ã‚°ã‚¤ãƒ³**
  1. ãƒˆãƒƒãƒ—ãƒšãƒ¼ã‚¸ â†’ ã€Œç®¡ç†è€…ã€é¸æŠ
  2. ãƒ¡ãƒ¼ãƒ«: admin@example.com, ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰: password123
  3. ãƒ­ã‚°ã‚¤ãƒ³æˆåŠŸ â†’ `/admin` ã«ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ
  4. ãƒ¦ãƒ¼ã‚¶ãƒ¼ä¸€è¦§ãŒè¡¨ç¤ºã•ã‚Œã‚‹

- [ ] **ã‚·ãƒŠãƒªã‚ª4: æœªãƒ­ã‚°ã‚¤ãƒ³ã§ã®ä¿è­·ã•ã‚ŒãŸãƒ«ãƒ¼ãƒˆã¸ã®ã‚¢ã‚¯ã‚»ã‚¹**
  1. ãƒ­ã‚°ã‚¢ã‚¦ãƒˆçŠ¶æ…‹
  2. `/mypage/orders` ã«ç›´æ¥ã‚¢ã‚¯ã‚»ã‚¹
  3. è‡ªå‹•çš„ã« `/mypage/login` ã«ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ

- [ ] **ã‚·ãƒŠãƒªã‚ª5: æ¨©é™ã‚¨ãƒ©ãƒ¼**
  1. ä¸€èˆ¬ãƒ¦ãƒ¼ã‚¶ãƒ¼ã§ãƒ­ã‚°ã‚¤ãƒ³ï¼ˆhanakoï¼‰
  2. `/admin` ã«ç›´æ¥ã‚¢ã‚¯ã‚»ã‚¹
  3. ã€Œã‚¢ã‚¯ã‚»ã‚¹æ¨©é™ãŒã‚ã‚Šã¾ã›ã‚“ã€ãŒè¡¨ç¤ºã•ã‚Œã‚‹

- [ ] **ã‚·ãƒŠãƒªã‚ª6: ãƒˆãƒ¼ã‚¯ãƒ³æœ‰åŠ¹æ€§**
  1. ãƒ­ã‚°ã‚¤ãƒ³å¾Œã€ãƒ–ãƒ©ã‚¦ã‚¶ã‚’ãƒªãƒ­ãƒ¼ãƒ‰
  2. `/mypage` ãŒè¡¨ç¤ºã•ã‚Œã‚‹ï¼ˆãƒˆãƒ¼ã‚¯ãƒ³ãŒ localStorage ã«ä¿å­˜ã•ã‚Œã¦ã„ã‚‹ï¼‰
  3. ãƒ–ãƒ©ã‚¦ã‚¶ã‚’é–‰ã˜ã¦å†åº¦é–‹ã
  4. `/mypage` ã«ã‚¢ã‚¯ã‚»ã‚¹ â†’ ãƒ­ã‚°ã‚¤ãƒ³çŠ¶æ…‹ãŒç¶­æŒã•ã‚Œã‚‹

---

## ğŸ”§ ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### ã‚¨ãƒ©ãƒ¼: "Invalid JWT"

**åŸå› :** JWT_SECRET ãŒè¨­å®šã•ã‚Œã¦ã„ãªã„ã€ã¾ãŸã¯ä¸€è‡´ã—ãªã„

**è§£æ±º:**
```bash
# backend/.env ã‚’ç¢ºèª
cat backend/.env

# JWT_SECRET ãŒã‚ã‚‹ã“ã¨ã‚’ç¢ºèª
# ãªã„å ´åˆã¯ä»¥ä¸‹ã‚’è¿½åŠ 
echo "JWT_SECRET=your-secret-key-here" >> backend/.env

# ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚’å†èµ·å‹•
cd backend
npm run dev
```

### ã‚¨ãƒ©ãƒ¼: "CORS policy"

**åŸå› :** ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ï¼ˆlocalhost:5173ï¼‰ã‹ã‚‰ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ï¼ˆlocalhost:3000ï¼‰ã¸ã®é€šä¿¡ãŒãƒ–ãƒ­ãƒƒã‚¯

**è§£æ±º:**
```javascript
// backend/src/server.js ã«è¿½åŠ 
const cors = require('cors');
app.use(cors({
  origin: 'http://localhost:5173',
  credentials: true,
}));
```

### ã‚¨ãƒ©ãƒ¼: "User not found" (ãƒ­ã‚°ã‚¤ãƒ³æ™‚)

**åŸå› :** Seed ãŒå®Ÿè¡Œã•ã‚Œã¦ã„ãªã„ã€ã¾ãŸã¯ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒä¸€è‡´ã—ãªã„

**è§£æ±º:**
```bash
# ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ç¢ºèª
mysql -u root -p ecommerce_db
SELECT * FROM users WHERE email = 'hanako@example.com';

# ãƒ‡ãƒ¼ã‚¿ãŒãªã„å ´åˆã€Seed ã‚’å®Ÿè¡Œ
cd db
npm run seed
```

### ã‚¨ãƒ©ãƒ¼: "Cannot use import statement outside a module"

**åŸå› :** ES Modules ãŒæ­£ã—ãè¨­å®šã•ã‚Œã¦ã„ãªã„

**è§£æ±º:**
```json
// backend/package.json ã«è¿½åŠ 
{
  "type": "module"
}
```

### ãƒ­ã‚°ã‚¤ãƒ³å¾Œã€ãƒšãƒ¼ã‚¸ãƒªãƒ­ãƒ¼ãƒ‰ã§ãƒ­ã‚°ã‚¢ã‚¦ãƒˆã•ã‚Œã‚‹

**åŸå› :** AuthContext ã®åˆæœŸåŒ–ãŒå®Œäº†ã™ã‚‹å‰ã«ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ

**è§£æ±º:** `frontend/src/contexts/AuthContext.jsx` ã® `isLoading` çŠ¶æ…‹ã‚’ç¢ºèª
```javascript
// ProtectedRoute ã§ isLoading ã‚’å¾…ã¤
if (isLoading) {
  return <div>Loading...</div>;
}
```

---

## ğŸ“Š å®Ÿè£…å¾Œã®ç¢ºèªäº‹é …

### ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹

```sql
-- ãƒ†ãƒ¼ãƒ–ãƒ«æ§‹é€ ç¢ºèª
DESCRIBE users;

-- ãƒ†ã‚¹ãƒˆã‚¢ã‚«ã‚¦ãƒ³ãƒˆç¢ºèª
SELECT id, name, email, role, is_active FROM users;

-- ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ç¢ºèª
SHOW INDEX FROM users;
```

**æœŸå¾…çµæœ:**
- `password` ã‚«ãƒ©ãƒ ãŒå­˜åœ¨ï¼ˆVARCHAR(255)ï¼‰
- `role` ã‚«ãƒ©ãƒ ãŒå­˜åœ¨ï¼ˆENUM('user', 'admin')ï¼‰
- `is_active` ã‚«ãƒ©ãƒ ãŒå­˜åœ¨ï¼ˆBOOLEANï¼‰
- admin, hanako, taro ã®3ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãŒç™»éŒ²æ¸ˆã¿

### ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰

```bash
# Health Check
curl http://localhost:3000/api/health

# ãƒ­ã‚°ã‚¤ãƒ³ãƒ†ã‚¹ãƒˆ
curl -X POST http://localhost:3000/api/auth/login \
  -H "Content-Type: application/json" \
  -d '{"email":"hanako@example.com","password":"password123"}'

# æœŸå¾…çµæœ: { "success": true, "data": { "token": "...", "user": {...} } }
```

### ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰

ãƒ–ãƒ©ã‚¦ã‚¶é–‹ç™ºè€…ãƒ„ãƒ¼ãƒ«ã§ç¢ºèª:

1. **Console ã‚¨ãƒ©ãƒ¼ãŒãªã„ã“ã¨**
2. **Network ã‚¿ãƒ–:** 
   - `/api/auth/login` â†’ 200 OK
   - `/api/auth/me` â†’ 200 OK (ãƒˆãƒ¼ã‚¯ãƒ³ä»˜ã)
3. **Application ã‚¿ãƒ– â†’ Local Storage:**
   - `token` ã‚­ãƒ¼ãŒå­˜åœ¨
   - å€¤ãŒJWTå½¢å¼ï¼ˆ`eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...`ï¼‰

---

## ğŸš€ æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—ï¼ˆç™ºå±•ï¼‰

### ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å¼·åŒ–

1. **ãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥ãƒˆãƒ¼ã‚¯ãƒ³å®Ÿè£…**
   - ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³: 15åˆ†ï¼ˆçŸ­ã„ï¼‰
   - ãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥ãƒˆãƒ¼ã‚¯ãƒ³: 7æ—¥ï¼ˆé•·ã„ï¼‰
   - å‚è€ƒ: [JWT Refresh Token Best Practices](https://auth0.com/blog/refresh-tokens-what-are-they-and-when-to-use-them/)

2. **httpOnly Cookie ã§ãƒˆãƒ¼ã‚¯ãƒ³ç®¡ç†**
   - localStorage â†’ httpOnly Cookie ã«å¤‰æ›´
   - XSSæ”»æ’ƒã¸ã®è€æ€§å‘ä¸Š
   - CSRFå¯¾ç­–ã‚‚å¿…é ˆ

3. **HTTPS å¯¾å¿œ**
   - æœ¬ç•ªç’°å¢ƒã§ã¯å¿…é ˆ
   - Let's Encrypt ã§ç„¡æ–™SSLè¨¼æ˜æ›¸

4. **Rate Limiting**
   - ãƒ–ãƒ«ãƒ¼ãƒˆãƒ•ã‚©ãƒ¼ã‚¹æ”»æ’ƒå¯¾ç­–
   - express-rate-limit ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ä½¿ç”¨

### æ©Ÿèƒ½è¿½åŠ 

1. **ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒªã‚»ãƒƒãƒˆ**
   - ãƒ¡ãƒ¼ãƒ«ã§ãƒªã‚»ãƒƒãƒˆãƒªãƒ³ã‚¯é€ä¿¡
   - nodemailer ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ä½¿ç”¨

2. **2è¦ç´ èªè¨¼ï¼ˆ2FAï¼‰**
   - Google Authenticator é€£æº
   - speakeasy ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ä½¿ç”¨

3. **ã‚½ãƒ¼ã‚·ãƒ£ãƒ«ãƒ­ã‚°ã‚¤ãƒ³**
   - Google OAuth
   - passport.js ä½¿ç”¨

4. **ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†ãƒšãƒ¼ã‚¸**
   - ãƒ­ã‚°ã‚¤ãƒ³ãƒ‡ãƒã‚¤ã‚¹ä¸€è¦§
   - é éš”ãƒ­ã‚°ã‚¢ã‚¦ãƒˆæ©Ÿèƒ½

---

## ğŸ“– å‚è€ƒè³‡æ–™

### JWT

- [RFC 7519: JSON Web Token](https://tools.ietf.org/html/rfc7519)
- [JWT.io: JWT Debugger](https://jwt.io/)
- [OWASP JWT Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/JSON_Web_Token_for_Java_Cheat_Sheet.html)

### bcrypt

- [bcrypt - npm](https://www.npmjs.com/package/bcrypt)
- [bcrypt ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚½ãƒ«ãƒˆ](https://ja.wikipedia.org/wiki/Bcrypt)

### React Context API

- [React Docs: Context](https://react.dev/reference/react/useContext)
- [When to use Context](https://react.dev/learn/passing-data-deeply-with-context)

### ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£

- [OWASP Top 10](https://owasp.org/www-project-top-ten/)
- [OWASP Authentication Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/Authentication_Cheat_Sheet.html)

---

## ğŸ“ ã¾ã¨ã‚

ã“ã®ã‚¬ã‚¤ãƒ‰ã§ã¯ã€ä»¥ä¸‹ã‚’å®Ÿè£…ã—ã¾ã—ãŸ:

âœ… **ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹å±¤:** èªè¨¼ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®è¿½åŠ ã€ãƒ†ã‚¹ãƒˆã‚¢ã‚«ã‚¦ãƒ³ãƒˆä½œæˆ  
âœ… **ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰å±¤:** JWTèªè¨¼APIã€ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ã€å½¹å‰²ãƒ™ãƒ¼ã‚¹ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡  
âœ… **ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰å±¤:** èªè¨¼UIã€ä¿è­·ã•ã‚ŒãŸãƒ«ãƒ¼ãƒˆã€çŠ¶æ…‹ç®¡ç†  

### èªè¨¼ãƒ•ãƒ­ãƒ¼å…¨ä½“

```
1. ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒç™»éŒ²/ãƒ­ã‚°ã‚¤ãƒ³
   â†“
2. ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ãŒJWTãƒˆãƒ¼ã‚¯ãƒ³ã‚’ç™ºè¡Œ
   â†“
3. ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ãŒ localStorage ã«ä¿å­˜
   â†“
4. ã™ã¹ã¦ã®APIãƒªã‚¯ã‚¨ã‚¹ãƒˆã«è‡ªå‹•ä»˜ä¸
   â†“
5. ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ãŒãƒˆãƒ¼ã‚¯ãƒ³ã‚’æ¤œè¨¼
   â†“
6. å½¹å‰²ã«å¿œã˜ã¦ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡
```

### ä¸»è¦ãªæŠ€è¡“æ±ºå®š

| é …ç›® | é¸æŠ | ç†ç”± |
|------|------|------|
| èªè¨¼æ–¹å¼ | JWT | ã‚¹ãƒ†ãƒ¼ãƒˆãƒ¬ã‚¹ã€ã‚¹ã‚±ãƒ¼ãƒ©ãƒ–ãƒ« |
| ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒãƒƒã‚·ãƒ¥ | bcrypt (cost 10) | ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã¨æ€§èƒ½ã®ãƒãƒ©ãƒ³ã‚¹ |
| ãƒˆãƒ¼ã‚¯ãƒ³ä¿å­˜ | localStorage | ã‚·ãƒ³ãƒ—ãƒ«ï¼ˆæœ¬ç•ªã§ã¯ httpOnly Cookieæ¨å¥¨ï¼‰ |
| çŠ¶æ…‹ç®¡ç† | React Context API | ä»Šå›ã®ã‚¹ã‚±ãƒ¼ãƒ«ã«æœ€é© |
| ãƒ«ãƒ¼ãƒˆä¿è­· | ProtectedRoute ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ | å†åˆ©ç”¨å¯èƒ½ã€å®£è¨€çš„ |

---

**ä½œæˆæ—¥:** 2026å¹´2æœˆ19æ—¥  
**ãƒãƒ¼ã‚¸ãƒ§ãƒ³:** 1.0  
**å¯¾è±¡:** Full-Stack Authentication System (MySQL + Node.js + React)
